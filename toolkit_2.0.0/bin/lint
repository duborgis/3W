#!/bin/bash
set -exu

# If CI is unset or empty, use true as the default value
CI="${CI:-true}"

cd "$(dirname "$0")"/..

LINT="ThreeWToolkit tests"

# Run mypy for type checking
mypy ${LINT}

if [ "${CI}" = true ]; then
    # In CI, only check code formatting and linting with Ruff
    black --check ${LINT}
    ruff check ${LINT}
    ruff format --check ${LINT}
else
    # Locally, automatically fix formatting issues with Ruff
    black ${LINT}
    ruff check --fix ${LINT} 
    ruff format ${LINT}
fi
